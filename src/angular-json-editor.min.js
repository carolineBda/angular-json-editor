"use strict";angular.module("angularJsonEditor",[]).factory("jsonService",[function(){return{getValue:function(a){try{return JSON.parse(a)}catch(b){return a}}}}]).directive("jsonEditor",function(){return{restrict:"E",replace:!0,scope:{content:"=",displayType:"@"},template:'<ul class="tree"><object-editor ng-repeat="(k, v) in content track by $index" key="k" value="content"></object-editor></ul>'}}).directive("objectEditor",["$compile",function(a){return{restrict:"E",replace:!0,scope:{key:"=",value:"=",objectType:"="},template:"<li></li>",link:function(b,c){var d=function(a){return"array"===a?'<div class="branch">&nbsp;</div>':"<span>{{key}}</span>"},e="",f=b.value[b.key];if(angular.isArray(f))e+=d(b.objectType)+'<json-editor display-type="array" content="value[key]"></json-editor>',e+='<new-leaf parent="value[key]"></new-leaf>';else if(angular.isObject(f))e+=d(b.objectType)+'<json-editor content="value[key]"></json-editor>',e+='<new-property parent="value[key]"></new-property>';else{var g=f&&f.length>100;e+=g?'<label>{{key}}</label><div class="large editor" ui-ace="{mode: \'text\'}" ng-model="value[key]"></div>':'<label>{{key}}</label><input type="text" name="{{key}}" class="small" ng-model="value[key]" />',e+='<remove-leaf parent="value" child="key"></remove-leaf>'}c.append(e),a(c.contents())(b)}}}]).directive("newLeaf",["jsonService",function(a){return{restrict:"E",replace:!0,scope:{parent:"="},template:'<div class="newLeaf"><input ng-model="propertyValue" type="text" class="small" /><button ng-click="addProperty()" title="Add" alt="+"></button></div>',link:function(b){b.addProperty=function(){b.parent.push(a.getValue(b.propertyValue))}}}}]).directive("newProperty",["jsonService",function(a){return{restrict:"E",replace:!0,scope:{parent:"="},template:'<div class="newLeaf"><input ng-model="propertyKey" type="text" class="small" />: <input ng-model="propertyValue" type="text" class="small" alt="+"/><button ng-click="addProperty()" title="Add"></button></div>',link:function(b){b.addProperty=function(){b.parent[b.propertyKey]=a.getValue(b.propertyValue)}}}}]).directive("removeLeaf",function(){return{restrict:"E",replace:!0,scope:{parent:"=",child:"="},template:'<button ng-click="removeProperty()" class="remove" title="Remove" alt="-"></button>',link:function(a){a.removeProperty=function(){angular.isArray(a.parent)?a.parent.splice(a.parent.indexOf(a.parent[a.child]),1):delete a.parent[a.child]}}}});